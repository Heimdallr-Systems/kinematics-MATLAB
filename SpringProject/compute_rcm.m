function r_I_sys_cm = compute_rcm(Theta,r_II_B)
% This function computes the vector position of the cm of the entire
% robotic system
% Theta = b(7,?)-b(18,?)
% r_II_B = [b(4,?);b(5,?);b(6,?)];

Theta1_FR = Theta(1);
Theta1_FL = Theta(2);
Theta1_BR = Theta(3);
Theta1_BL = Theta(4);
Theta2_FR = Theta(5);
Theta2_FL = Theta(6);
Theta2_BR = Theta(7);
Theta2_BL = Theta(8);
Theta3_FR = Theta(9);
Theta3_FL = Theta(10);
Theta3_BR = Theta(11);
Theta3_BL = Theta(12);

r_B_sys_cm = [(158979741669372749733066978379063*sin(Theta1_BR))/38909738785192413116683761221632000 - (158979741669372749733066978379063*sin(Theta1_FL))/38909738785192413116683761221632000 - (158979741669372749733066978379063*sin(Theta1_BL))/38909738785192413116683761221632000 + (158979741669372749733066978379063*sin(Theta1_FR))/38909738785192413116683761221632000 + (9421071482335975200864871983513*cos(Theta1_BL)^2)/9960893129009257757871042872737792 - (9421071482335975200864871983513*cos(Theta1_FL)^2)/9960893129009257757871042872737792 + (9421071482335975200864871983513*cos(Theta1_BR)^2)/9960893129009257757871042872737792 - (9421071482335975200864871983513*cos(Theta1_FR)^2)/9960893129009257757871042872737792 - (9421071482335975200864871983513*sin(Theta1_BL)^2)/9960893129009257757871042872737792 + (9421071482335975200864871983513*sin(Theta1_FL)^2)/9960893129009257757871042872737792 - (9421071482335975200864871983513*sin(Theta1_BR)^2)/9960893129009257757871042872737792 + (9421071482335975200864871983513*sin(Theta1_FR)^2)/9960893129009257757871042872737792 - (15570750395702335*cos(Theta1_BL)*cos(Theta2_BL)*sin(Theta1_BL))/1105881289765659776 - (15570750395702335*cos(Theta1_FL)*cos(Theta2_FL)*sin(Theta1_FL))/1105881289765659776 + (15570750395702335*cos(Theta1_BR)*cos(Theta2_BR)*sin(Theta1_BR))/1105881289765659776 + (15570750395702335*cos(Theta1_FR)*cos(Theta2_FR)*sin(Theta1_FR))/1105881289765659776 - (4372016150985706923176338881103*cos(Theta1_BL)*sin(Theta1_BL)*sin(Theta2_BL))/637497160256592496503746743855218688 - (4372016150985706923176338881103*cos(Theta1_FL)*sin(Theta1_FL)*sin(Theta2_FL))/637497160256592496503746743855218688 - (4372016150985706923176338881103*cos(Theta1_BR)*sin(Theta1_BR)*sin(Theta2_BR))/637497160256592496503746743855218688 - (4372016150985706923176338881103*cos(Theta1_FR)*sin(Theta1_FR)*sin(Theta2_FR))/637497160256592496503746743855218688 - (57324412161141119794540447421463*cos(2*Theta1_BL)*cos(Theta2_BL + Theta3_BL)*sin(Theta1_BL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(2*Theta1_FL)*cos(Theta2_FL + Theta3_FL)*sin(Theta1_FL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_BR)*cos(Theta2_BR + Theta3_BR)*sin(Theta1_BR))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_FR)*cos(Theta2_FR + Theta3_FR)*sin(Theta1_FR))/19921786258018515515742085745475584 + (57324412161141119794540447421463*sin(2*Theta1_BL)*sin(Theta2_BL + Theta3_BL)*sin(Theta2_BL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*sin(2*Theta1_FL)*sin(Theta2_FL + Theta3_FL)*sin(Theta2_FL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*sin(2*Theta1_BR)*sin(Theta2_BR + Theta3_BR)*sin(Theta2_BR))/19921786258018515515742085745475584 - (57324412161141119794540447421463*sin(2*Theta1_FR)*sin(Theta2_FR + Theta3_FR)*sin(Theta2_FR))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(Theta2_BL + Theta3_BL)*cos(Theta1_BL)^2*cos(Theta2_BL)*sin(Theta1_BL))/9960893129009257757871042872737792 - (57324412161141119794540447421463*cos(Theta2_FL + Theta3_FL)*cos(Theta1_FL)^2*cos(Theta2_FL)*sin(Theta1_FL))/9960893129009257757871042872737792 + (57324412161141119794540447421463*cos(Theta2_BR + Theta3_BR)*cos(Theta1_BR)^2*cos(Theta2_BR)*sin(Theta1_BR))/9960893129009257757871042872737792 + (57324412161141119794540447421463*cos(Theta2_FR + Theta3_FR)*cos(Theta1_FR)^2*cos(Theta2_FR)*sin(Theta1_FR))/9960893129009257757871042872737792 + 4790821226775173/2211762579531319552;...
(9421071482335975200864871983513*sin(2*Theta1_BL))/9960893129009257757871042872737792 - (9421071482335975200864871983513*sin(2*Theta1_FL))/9960893129009257757871042872737792 + (9421071482335975200864871983513*sin(2*Theta1_BR))/9960893129009257757871042872737792 - (9421071482335975200864871983513*sin(2*Theta1_FR))/9960893129009257757871042872737792 + (158979741669372749733066978379063*cos(Theta1_BL))/38909738785192413116683761221632000 + (158979741669372749733066978379063*cos(Theta1_FL))/38909738785192413116683761221632000 - (158979741669372749733066978379063*cos(Theta1_BR))/38909738785192413116683761221632000 - (158979741669372749733066978379063*cos(Theta1_FR))/38909738785192413116683761221632000 + (15570750395702335*cos(Theta1_BL)^2*cos(Theta2_BL))/2211762579531319552 + (15570750395702335*cos(Theta1_FL)^2*cos(Theta2_FL))/2211762579531319552 - (15570750395702335*cos(Theta1_BR)^2*cos(Theta2_BR))/2211762579531319552 - (15570750395702335*cos(Theta1_FR)^2*cos(Theta2_FR))/2211762579531319552 - (15570750395702335*cos(Theta2_BL)*sin(Theta1_BL)^2)/2211762579531319552 + (4372016150985706923176338881103*cos(Theta1_BL)^2*sin(Theta2_BL))/1274994320513184993007493487710437376 - (15570750395702335*cos(Theta2_FL)*sin(Theta1_FL)^2)/2211762579531319552 + (4372016150985706923176338881103*cos(Theta1_FL)^2*sin(Theta2_FL))/1274994320513184993007493487710437376 + (15570750395702335*cos(Theta2_BR)*sin(Theta1_BR)^2)/2211762579531319552 + (4372016150985706923176338881103*cos(Theta1_BR)^2*sin(Theta2_BR))/1274994320513184993007493487710437376 + (15570750395702335*cos(Theta2_FR)*sin(Theta1_FR)^2)/2211762579531319552 + (4372016150985706923176338881103*cos(Theta1_FR)^2*sin(Theta2_FR))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*sin(Theta1_BL)^2*sin(Theta2_BL))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*sin(Theta1_FL)^2*sin(Theta2_FL))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*sin(Theta1_BR)^2*sin(Theta2_BR))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*sin(Theta1_FR)^2*sin(Theta2_FR))/1274994320513184993007493487710437376 - (57324412161141119794540447421463*cos(Theta2_BL + Theta3_BL)*cos(Theta1_BL)*sin(Theta1_BL)^2)/9960893129009257757871042872737792 - (57324412161141119794540447421463*cos(Theta2_FL + Theta3_FL)*cos(Theta1_FL)*sin(Theta1_FL)^2)/9960893129009257757871042872737792 + (57324412161141119794540447421463*cos(Theta2_BR + Theta3_BR)*cos(Theta1_BR)*sin(Theta1_BR)^2)/9960893129009257757871042872737792 + (57324412161141119794540447421463*cos(Theta2_FR + Theta3_FR)*cos(Theta1_FR)*sin(Theta1_FR)^2)/9960893129009257757871042872737792 - (57324412161141119794540447421463*cos(2*Theta1_BL)*sin(Theta2_BL + Theta3_BL)*sin(Theta2_BL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(2*Theta1_FL)*sin(Theta2_FL + Theta3_FL)*sin(Theta2_FL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_BR)*sin(Theta2_BR + Theta3_BR)*sin(Theta2_BR))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_FR)*sin(Theta2_FR + Theta3_FR)*sin(Theta2_FR))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_BL)*cos(Theta2_BL + Theta3_BL)*cos(Theta1_BL)*cos(Theta2_BL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(2*Theta1_FL)*cos(Theta2_FL + Theta3_FL)*cos(Theta1_FL)*cos(Theta2_FL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(2*Theta1_BR)*cos(Theta2_BR + Theta3_BR)*cos(Theta1_BR)*cos(Theta2_BR))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(2*Theta1_FR)*cos(Theta2_FR + Theta3_FR)*cos(Theta1_FR)*cos(Theta2_FR))/19921786258018515515742085745475584 - 757649839309791/1105881289765659776;...
(15570750395702335*sin(Theta2_BL))/2211762579531319552 - (4372016150985706923176338881103*cos(Theta2_FL))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*cos(Theta2_BR))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*cos(Theta2_FR))/1274994320513184993007493487710437376 - (4372016150985706923176338881103*cos(Theta2_BL))/1274994320513184993007493487710437376 + (15570750395702335*sin(Theta2_FL))/2211762579531319552 - (15570750395702335*sin(Theta2_BR))/2211762579531319552 - (15570750395702335*sin(Theta2_FR))/2211762579531319552 + (57324412161141119794540447421463*sin(Theta2_BL + Theta3_BL)*cos(Theta2_BL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*sin(Theta2_FL + Theta3_FL)*cos(Theta2_FL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*sin(Theta2_BR + Theta3_BR)*cos(Theta2_BR))/19921786258018515515742085745475584 - (57324412161141119794540447421463*sin(Theta2_FR + Theta3_FR)*cos(Theta2_FR))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(Theta2_BL + Theta3_BL)*cos(Theta1_BL)*sin(Theta2_BL))/19921786258018515515742085745475584 + (57324412161141119794540447421463*cos(Theta2_FL + Theta3_FL)*cos(Theta1_FL)*sin(Theta2_FL))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(Theta2_BR + Theta3_BR)*cos(Theta1_BR)*sin(Theta2_BR))/19921786258018515515742085745475584 - (57324412161141119794540447421463*cos(Theta2_FR + Theta3_FR)*cos(Theta1_FR)*sin(Theta2_FR))/19921786258018515515742085745475584 + 95496879291262886863/2764703224414149440000];

r_I_sys_cm = r_II_B + r_B_sys_cm;
end